# 操作系统

## 死锁
>死锁是指两个或两个以上的进程在执行过程中，由于竞争资源或者由于彼此通信而造成的一种阻塞的现象，若无外力作用，它们都将无法推进下去。此时称系统处于死锁状态或系统产生了死锁，这些永远在互相等待的进程称为死锁进程。 ——百度百科
### 死锁的四个必要条件
1. 互斥条件：一个资源每次只能被一个进程使用。
2. 请求和保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。
3. 不剥夺条件:进程已获得的资源，在末使用完之前，不能强行剥夺。
4. 环路等待条件: 发生死锁时，若干进程之间形成一种头尾相接的循环等待资源关系。

### 如何避免死锁
#### 有序资源分配算法
为每类资源设置一个编号（例如打印机为1、磁带机为2、磁盘为3、等等），按照编号的大小对资源进行排序，每个进程在申请资源时，必须按照资源编号的顺序申请。
- 要求进程：
    
    1. 对它所必须使用的而且属于同一类的所有资源，必须一次申请完；
    2. 在申请不同类资源时，必须按各类设备的编号依次申请。例如：进程PA，使用资源的顺序是R1，R2； 进程PB，使用资源的顺序是R2，R1；若采用动态分配有可能形成环路条件，造成死锁。

- 采用有序资源分配法：R1的编号为1，R2的编号为2；
- PA：申请次序应是：R1，R2
- PB：申请次序应是：R1，R2
- 这样就破坏了环路条件，避免了死锁的发生

#### 银行家算法
这是一种用于进程之前判断死锁的方法，其适用于不可抢夺的条件下。它是基于银行家对资源的管理方法，即银行家在发放贷款时，必须先判断客户是否有能力偿还贷款，如果没有，就不发放贷款。银行家算法的基本思想是：当有多个进程同时申请资源时，系统必须判断此时系统是否处于安全状态，如果是，则允许进程申请资源，否则，进程只能等待。如果就绪队列没有一个进程可以运行，那么系统就处于不安全状态，我们则判断这些进程可能发生死锁